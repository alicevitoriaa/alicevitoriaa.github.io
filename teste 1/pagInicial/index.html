<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <title>Bem vindo! - Alice Vitória</title>
        <link rel="shortcut icon" href="../logo.png" type="image/x-icon">
        <script src="../VueJS/vue.js"></script>
        <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
        <link rel="stylesheet" href="stylePI.css">
    </head>

    <body>
        <div id="app">
            <header id="head">
                <div class="emp"><img style="width: 50px;" src="../logo.png" alt="logo">revisão.com</div>
                <div class="emp">{{boasVindas}}<img style="width: 40px; height: 40px; cursor: pointer;" src="../perfil.png" alt="perfil"></div>
            </header>

            <div id="container">
                <div id="add">
                    <div v-if="carros.length === 0" style="display: flex; flex-direction: column; align-items: center; gap: 10px; font-weight: 600">
                        <img style="width: 60px; cursor: pointer" src="../mais.png" @click="this.pg = 'c'">Clique para adicionar carro
                    </div>
                </div>

                <div id="cards">
                    <div style="font-size: 20px; font-weight: 600; margin-bottom: 30px;">Seus carros registrados ({{total}})</div>
                    <div id="carros"></div>
                </div>
            </div>
        </div>

        <script>

            partes = window.location.search.slice(3)
            partes = JSON.parse(decodeURIComponent(partes.replace(/\+/g, " ")))
        
            // iniciar #app
            new Vue({
                el: '#app',
                data: {
                    boasVindas: "Olá, " + partes[0]['nome'].split(' ')[0],
                    pg: "ola",
                    carros: [],
                    total: 1
                },
                methods: {

                    carregarCarros(){

                        $.post('../api/carregarCarros.php', {id: partes[0]['id']}).done(bk => {

                            if(bk != "erro" && JSON.parse(bk) == ""){

                                this.carros = [];

                            }else{
                                
                                this.carros = 1
                                var carro = JSON.parse(bk)
                                $('#cards').show()


//                                for(var i = 0; i < carro.lenght; i++){
                                    var html = `<div class="cad">
                                        <div style="height: 60%"><img style="object-fit: cover; height: 100%; width: 100%; border-radius: 30px" src="../honda.jfif"></div>
                                        <div style="margin-top: 30px">
                                            <div><b>Marca:</b> ${carro[0]['marca']}</div>
                                            <div><b>Modelo:</b> ${carro[0]['modelo']} (${carro[0]['ano']})</div>
                                            <div><b>Cor:</b> ${carro[0]['cor']}</div>
                                        </div>
                                        </div>`

                                    $('#carros').html(html)
  //                              }

                            }
                            
                        })
                    },

                    
                },
                
                mounted() {
                    this.carregarCarros(); // Chama automaticamente ao montar o componente
                }
            });

        </script>

    </body>
</html>
